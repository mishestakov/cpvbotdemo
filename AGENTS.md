# AGENTS.md

## Контекст проекта
- Делаем прототип Telegram-бота.
- Главный источник по API: `telegrambotapi.md`.

## Правила для Codex
- Перед любыми изменениями, связанными с Telegram API, сначала смотреть релевантные места в `telegrambotapi.md` и опираться на них, а не на догадки.
- Писать минимально необходимый код под задачу пользователя: без лишних веток, абстракций и "на будущее".
- Если доработка получается заметно большой (много новых строк/файлов), сначала спросить пользователя, точно ли нужно расширять решение.
- Если пользователь запрашивает большую фичу, не делать монолитный коммит: сначала предлагать пошаговую разбивку на гранулярные изменения, каждое из которых можно изолированно проверить.
- Для больших фич после каждого шага фиксировать критерий проверки (что именно должно работать), показывать результат проверки и только потом переходить к следующему шагу.
- При большой задаче проектировать шаги так, чтобы их можно было выполнять параллельно в нескольких клонах репозитория (несколько Codex-сессий).
- Для параллельной работы формировать независимые потоки изменений:
  - каждый поток должен иметь минимальные пересечения по файлам;
  - у каждого потока должен быть собственный проверяемый результат;
  - перед стартом следующего потока явно фиксировать точки интеграции (какие файлы/контракты должны совпадать).
- Если задача плохо делится на параллельные потоки, сначала предложить пользователю вариант декомпозиции, пригодный для параллельной разработки.
- Если пользователь спрашивает "почему тут так", сначала объяснять текущее решение; не раздувать код без явного запроса.
- Перед добавлением новой зависимости сначала спросить пользователя, нужно ли подключать пакет.
- При предложении зависимости кратко объяснять, зачем она нужна и почему без нее хуже/сложнее.
- Если зависимость крупная или "тяжелая", отдельно подтверждать у пользователя, что он согласен на ее добавление.
- Перед архитектурным выбором (например, "с зависимостью vs без зависимости") сначала давать сравнение вариантов до изменений.
- Сравнение вариантов должно включать:
  - ориентировочный прирост/снижение объема кода;
  - риски багов и сложность поддержки;
  - скорость реализации сейчас и стоимость изменений потом.
- После сравнения явно спрашивать подтверждение выбранного варианта перед внедрением.
- Если решение может заметно увеличить объем boilerplate, не делать его молча: сначала предупредить пользователя с конкретной оценкой.

## Лог разработки (`creation.md`)
- Вести `creation.md` как журнал "the making of": что попросил пользователь, что сделано, какие решения/ограничения приняты.
- Обновлять журнал по ходу работы, чтобы потом из него можно было собрать финальное ТЗ и "one-prompt" описание.
- Избегать воды: короткие записи по сути.

## Коммиты
- После каждого существенного изменения, которое понравилось пользователю, спрашивать: "Норм, коммитим?"
- Не коммитить автоматически без подтверждения пользователя.
- Перед коммитом при необходимости дать пользователю время на ревью/чистку.
